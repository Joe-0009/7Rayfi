<div class="tab-pane fade" id="jobs" role="tabpanel" aria-labelledby="jobs-tab">
    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Posted Jobs</h5>
                    <ul class="list-unstyled">
                        {% if posted_jobs %}
                            {% for job in posted_jobs %}
                                <li class="mb-4">
                                    <h6>
                                        <a href="{{ url_for('job.job_details', job_id=job.id) }}">{{ job.title }}</a>
                                        <span class="badge bg-{{ job.status|lower }}">{{ job.status }}</span>
                                    </h6>
                                    <small>Posted on: {{ job.date_posted.strftime('%B %d, %Y at %I:%M %p') }}</small>
                                    <ul class="list-unstyled mt-2">
                                        {% if job.applications %}
                                            {% for application in job.applications %}
                                                <li class="mb-2">
                                                    <strong>{{ application.applicant.first_name }} {{ application.applicant.last_name }}</strong>
                                                    {% if job.status == 'Open' %}
                                                        <form method="POST" action="{{ url_for('job.accept_application', job_id=job.id, application_id=application.id) }}" class="d-inline">
                                                            {{ form.hidden_tag() }}
                                                            <button type="submit" class="btn btn-success btn-sm" onclick="return confirm('Are you sure you want to accept this application?')">Accept</button>
                                                        </form>
                                                    {% endif %}
                                                </li>
                                            {% endfor %}
                                        {% else %}
                                            <li>No applications yet</li>
                                        {% endif %}
                                    </ul>
                                    <div class="job-actions mt-2">
                                        <form method="POST" action="{{ url_for('job.delete_job', job_id=job.id) }}" class="d-inline">
                                            {{ form.hidden_tag() }}
                                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this job?')">Delete</button>
                                        </form>
                                        {% if job.status == 'In Progress' %}
                                            <a href="{{ url_for('job.finish_job', job_id=job.id) }}" class="btn btn-success btn-sm">Finish & Rate</a>
                                        {% endif %}
                                    </div>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li>No jobs posted</li>
                        {% endif %}
                    </ul>
                    {% if posted_jobs.has_prev or posted_jobs.has_next %}
                        <nav aria-label="Posted jobs pagination">
                            <ul class="pagination">
                                {% if posted_jobs.has_prev %}
                                    <li class="page-item"><a class="page-link" href="{{ url_for('profile.view_profile', user_id=current_user.id, posted_page=posted_jobs.prev_num) }}">Previous</a></li>
                                {% endif %}
                                {% if posted_jobs.has_next %}
                                    <li class="page-item"><a class="page-link" href="{{ url_for('profile.view_profile', user_id=current_user.id, posted_page=posted_jobs.next_num) }}">Next</a></li>
                                {% endif %}
                            </ul>
                        </nav>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Applied Jobs</h5>
                    <ul class="list-unstyled">
                        {% if applied_jobs %}
                            {% for application in applied_jobs %}
                                <li class="mb-3">
                                    <h6>
                                        <a href="{{ url_for('job.job_details', job_id=application.id) }}">{{ application.title }}</a>
                                        <span class="badge bg-{{ application.job.status|lower }}">{{ application.job.status }}</span>
                                    </h6>
                                    <small>Applied on: {{ application.date_applied.strftime('%B %d, %Y at %I:%M %p') }}</small>
                                    <br>
                                    <small>Job status: {{ application.job.status }}</small>
                                    <br>
                                    <small>Application status: 
                                        {% if application.job.accepted_worker_id == current_user.id %}
                                            <span class="text-success">Accepted</span>
                                        {% elif application.job.status == 'Open' %}
                                            <span class="text-warning">Pending</span>
                                        {% else %}
                                            <span class="text-danger">Not selected</span>
                                        {% endif %}
                                    </small>
                                    {% if application.job.status == 'Finished' and application.job.accepted_worker_id == current_user.id %}
                                        <br>
                                        <a href="{{ url_for('job.rate_job', job_id=application.job.id) }}" class="btn btn-primary btn-sm mt-2">Rate Job</a>
                                    {% endif %}
                                </li>
                            {% endfor %}
                        {% else %}
                            <li>No jobs applied for</li>
                        {% endif %}
                    </ul>
                    {% if applied_jobs.has_prev or applied_jobs.has_next %}
                        <nav aria-label="Applied jobs pagination">
                            <ul class="pagination">
                                {% if applied_jobs.has_prev %}
                                    <li class="page-item"><a class="page-link" href="{{ url_for('profile.view_profile', user_id=current_user.id, applied_page=applied_jobs.prev_num) }}">Previous</a></li>
                                {% endif %}
                                {% if applied_jobs.has_next %}
                                    <li class="page-item"><a class="page-link" href="{{ url_for('profile.view_profile', user_id=current_user.id, applied_page=applied_jobs.next_num) }}">Next</a></li>
                                {% endif %}
                            </ul>
                        </nav>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>